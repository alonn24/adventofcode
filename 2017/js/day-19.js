let input = '                                                           |                                                                                                                                             \n' +
  '                                       +-----------------------------------+       +-+         +-------------------------------------------------------------------------------------------+   +-+       \n' +
  '                                       |                   |               |       | |         |                                                                                           |   | |       \n' +
  '                                       +-----------------+ |       +-----+ | +-----+ |         |                                             +---------------------------------------------|---+ |       \n' +
  '                                                         | |       |     | | |       |         |                                             |                                             |     |       \n' +
  '                                                         +-------------+ +-+ |       |         | +---------------+                           |                                             |     |       \n' +
  '                                                           |       |   |     |       |         | |               |                           |                                             |     |       \n' +
  '               +---------------------------------------------------------------------|---------|-----------+     |                           |                       +---------------------|-----+       \n' +
  '               |                                           |       |   |     |       |         | |         |     |                           |                       |                     |             \n' +
  '               |                                           |       +-----+ +-------------------+ +-+       +-------------------------------------------------------------------------------------------+ \n' +
  '               |                                           |           | | | |       |             |             |                           |                       |                     |           | \n' +
  '               |                                   +-------|-------+   | +-|-+   +---|-------------------------------------------------------|---------------------------------------------|---+       | \n' +
  '               |                                   |       |       |   |   |     |   |             |             |                           |                       |                     |   |       | \n' +
  '               |                                   |       |       |   | +-|-----|---------+       +-----------------------------------------------------------------|-------------------------|---+   | \n' +
  '               |                                   |       |       |   | | |     |   |     |                     |                           |                       |                     |   |   |   | \n' +
  '               |                     +-----------------------------|---|---|-----|---|-------------------------------------------+           |   +-------------------|-------------------------+ +-+   | \n' +
  '               |                     |             |       |       |   | | |     |   |     |                     |               |           |   |                   |                     |     |     | \n' +
  '               |     +---------------|-------------|-------|-------------|-----------|-----|-------------------------------------|-----------------------------------|---------------------------+ +-+ | \n' +
  '               |     |               |             |       |       |   | | |     |   |     |                     |               |           |   |                   |                     |       | | | \n' +
  '               |     |               |             |       |       |   | | |     |   |     |                     |               |           |   |               +---|---+             +-----------+ +-+ \n' +
  '               |     |               |             |       |       |   | | |     |   |     |                     |               |           |   |               |   |   |             |   |             \n' +
  '               |     | +-------------|---------------------|-------|-----|-----------|-----|---------------------|---------------|---------------|-------+       |   |   |             |   |             \n' +
  '               |     | |             |             |       |       |   | | |     |   |     |                     |               |           |   |       |       |   |   |             |   |             \n' +
  '               | +---|-|---------------------------|---------------|---+ | |     +---|-----|-----------------+   |               |       +---|-------------+     |   |   |             |   | +-+         \n' +
  '               | |   | |             |             |       |       |     | |         |     |                 |   |               |       |   |   |       | |     |   |   |             |   | | |         \n' +
  '               | |   | |             |             |       |       |     | |         |     |                 | +-------------------+     +-+ |   +-----------------------------------+ |   | | |         \n' +
  '               | |   | |             |             |       |       |     | |         |     |                 | | |               | |       | |           | |     |   |   |           | |   | | |         \n' +
  '               | |   +---------------|-------------|---------------|-------|---------|-----|-+               | | |               | |       | |           | | +-----------|-------------+   | | |         \n' +
  '               | |     |             |             |       |       |     | |         |     | |               | | |               | P       | |           | | |   |   |   |           |     | | |         \n' +
  '               | |     |             |             |       |       |     | |       +-|-------------------------|-|---------------|-|---------|-----------|-------|-------|-----------+     | +-------+   \n' +
  '               | |     |             |             |       |       |     | |       | |     | |               | | |               | |       | |           | | |   |   |   |                 |   |     |   \n' +
  ' +-------------+ |     |             |           +---------|---------------|-------|-|-----|-----------------|-|-|---+           | |       | |           | | |   |   |   |             +-----+ |     +-+ \n' +
  ' |               |     |             |           | |       |       |     | |       | |     | |               | | |   |           | |       | |           | | |   |   |   |             |   | | |       | \n' +
  ' +-----+         |     |             |           | |       |       |     | +---------------|-----------------|-|-|-------------------------------------------|---|---|---------------------|-------+   | \n' +
  '       |         |     |             |           | |       |       |     |         | |     | |               | | |   |           | |       | |           | | |   |   |   |             |   | | |   |   | \n' +
  '       |         |     |             |     +---------------|-------------|---------|-|-----|-------+         | | |   |           | |     +---|-------------+ |   |   |   |             |   | +-+   |   | \n' +
  '       |         |     |             |     |     | |       |       |     |         | |     | |     |         | | |   |           | |     | | |           |   |   |   |   |             |   |       |   | \n' +
  '       |         |     |             |     |     | |       |       |     |         | |     | |     |         | | |   |           | |     | | |           +-------|---------------------|---|-+   +---+ | \n' +
  '       |         |     |             |     |     | |       |       |     |         | |     | |     |         | | |   |           | |     | | |               |   |   |   |             |   | |   | | | | \n' +
  '       |         |     |             |     |     | |       |       |     |         | |     | |     |         | | |   |           | |     | | |               |   |   |   |   +---------|---|-+   | | | | \n' +
  '       |         |     |             |     |     | |       |       |     |         | |     | |     |         | | |   |           | |     | | |               |   |   |   |   |         |   |     | | | | \n' +
  ' +---------------------|-------------|-----|-----|-|-------|-------|---------------|-|-----|-|-----|---------|---|---|-------------|-+   | | |               |   +---|---|-------------|-----+   | | | | \n' +
  ' |     |         |     |             |     |     | |       |       |     |         | |     | |     |         | | |   |           | | |   | | |               |       |   |   |         |   | |   | | | | \n' +
  ' |     +---------+     |             |     |     | |   +---|-+     |     |         | |     | |     |         | | |   |           | | |   | | |     +---------|---+   |   +---|-+       |   | |   | | | | \n' +
  ' |                     |             |     |     | |   |   | |     |     |         | |     | |     |         | | |   |           | | |   | | |     |         |   |   |       | |       |   | |   | | | | \n' +
  ' |     +-----------------+           |     |     | |   |   | |     |     |         | |     | |     |         | | |   |           | | |   | | |     |         |   |   |       | |       |   | |   | | | | \n' +
  ' |     |               | |           |     |     | |   |   | |     |     |         | |     | |     |         | | |   |           | | |   | | |     |         |   |   |       | |       |   | |   | | | | \n' +
  ' |     |               | +-----------|-----|-----|-----|---|-|-----|---------------|-------|-|-----------------------|---------------------+ |     |         |   |   |       | |       |   | |   | | | | \n' +
  ' |     |               |             |     |     | |   |   | |     |     |         | |     | |     |         | | |   |           | | |   |   |     |         |   |   |       | |       |   | |   | | | | \n' +
  ' |     |     +-+       |             |     |     | |   |   | |     |     |         | |     | |     |         | | |   |           | | |   |   |     |         |   |   |   +---|-|-----------|-----+ | | | \n' +
  ' |     |     | |       |             |     |     | |   |   | |     |     |         | |     | |     |         | | |   |           | | |   |   |     |         |   |   |   |   | |       |   | |     | | | \n' +
  ' |     |     | |     +---+           |     |     | |   |   | |     +-----+         | |   +-|-+   +-------------|-|---|-----------|-------|---|---+ |         |   |   |   | +-+ |       |   | +---------+ \n' +
  ' |     |     | |     | | |           |     |     | |   |   | |                     | |   | |     | |         | | |   |           | | |   |   |   | |         |   |   |   | |   |       |   |       | |   \n' +
  ' |     |     | |     | | |           |     |   +-|-|---|---|-|---------------------|-----|-|---------------------|-----------------|-----|---------+         |   |   |   | |   |       |   |       | |   \n' +
  ' |     |     | |     | | |           |     |   | | |   |   | |                     | |   | |     | |         | | |   |           | | |   |   |   |           |   |   |   | |   |       |   |       | |   \n' +
  ' |     |     | |     | | |           |     +---+ | |   |   | |                     | |   | |     | |         | | |   |           | | | +-|-------------------|-----------|-+   |       |   |       | |   \n' +
  ' |     |     | |     | | |           |           | |   |   | |                     | |   | |     | |         | | |   |           | | | | |   |   |           |   |   |   |     |       |   |       | |   \n' +
  ' |     |     | |     | | |           |           | |   |   | |                     | |   | |     | |         | | |   |           | | | | |   | +-----------------|-------|-----------+ |   |       | |   \n' +
  ' |     |     | |     | | |           |           | |   |   | |                     | |   | |     | |         | | |   |           | | | | |   | | |           |   |   |   |     |     | |   |       | |   \n' +
  ' |     |     | |     | | +-----------|-----------------|---|-|-------------+       | |   | |     | |         | | |   |           | | | | |   | | |           |   |   |   |     |     | |   |       | |   \n' +
  ' |     |     | |     | |             |           | |   |   | |             |       | |   | |     | |         | | |   |           | | | | |   | | |           |   |   |   |     |     | |   |       | |   \n' +
  ' |     |     | |     | |             |           | |   |   | |             |       | |   | |     | | +-------|-|-|---|-----------------|---------|---------------|-+ |   |     |     | |   |       | |   \n' +
  ' |     |     | |     | |             |           | |   |   | |             |       | |   | |     | | |       | | |   |           | | | | |   | | |           |   | | |   |     |     | |   |       | |   \n' +
  ' |     |     | |     | |             |           | |   |   | |             |       | |   | |     | | |       | | +---|-------------|---|-|---|---------------|---|-|-----+     |     | |   |       | |   \n' +
  ' |     |     | |     | |             |           | |   |   | |             |       | |   | |     | | |       | |     |           | | | | |   | | |           |   | | |         |     | |   |       | |   \n' +
  ' |     |     | |     +---------------|-----------|-----|-+ | |             |       | |   | |     | | |       | |   +-|-----------|-------|---|-|-+           |   | | |         |     | |   |       | |   \n' +
  ' |     |     | |       |             |           | |   | | | |             |       | |   | |     | | |       | |   | |           | | | | |   | |             |   | | |         |     | |   |       | |   \n' +
  ' |     |     | |       |             |           | |   | | | |             |       | |   | |     | | |       | |   | |           | | | | |   | |             |   | | |         |     | |   |       | |   \n' +
  ' |     |     | |       |             |           | |   | | | |             |       | |   | |     | | |       | |   | |           | | | | |   | |             |   | | |         |     | |   |       | |   \n' +
  ' |     |     | |       |             |           | |   | | | |             |       | |   | |     | | |       | |   | |           | | | | |   | |             |   | | |         |     | |   |       | |   \n' +
  ' |     |     | |       |             |           | |   | | | |             |       | |   | |     | | |       | |   | |           | | | | |   | |             |   | | |         |     | |   |       | |   \n' +
  ' |     |     | |       |             |           | |   | +---|-------------------------+ | +-----|-----------|-------|-----------|-|-|-------|---------------|-+ | | |         |     | |   |       | |   \n' +
  ' |     |     | |       |             |           | |   |   | |             |       | | | |       | | |       | |   | |           | | | | |   | |             | | | | |         |     | |   |       | |   \n' +
  ' |     |     | |       |             |           | |   |   | |             |       | | | |       +-------------|---|-------------|-|---|-|---------+         | | | | |         |     | |   |       | |   \n' +
  ' |     |     | |       |             |           | |   |   | |             |       | | | |         | |       | |   | |           | | | | |   | |   |         | | | | |         |     | |   |       | |   \n' +
  ' |     |     | |       |             |           | |   |   | |             |       | | | |         | |       | |   | |           | | | | |   | |   |         | | | | |         |     | |   |       | |   \n' +
  ' |     |     | |       |             |           | |   |   | |             |       | | | |         | |       | |   | |           | | | | |   | |   |         | | | | |         |     | |   |       | |   \n' +
  ' |     |     | |     +---------------|-------------|---|-----+     +-------|-------|-----|---------|-----------|---|-|-------------|-|-|-|-----|-------------|-|-|-|-----------|-----|-------+     | |   \n' +
  ' |     |     | |     | |             |           | |   |   |       |       |       | | | |         | |       | |   | |           | | | | |   | |   |         | | | | |         |     | |   | |     | |   \n' +
  ' | +---|-+   | |     | |             |           | |   |   |       |       |       | | | |         | |       | |   | |           | | | | |   | |   |         | | | | |         |     | |   | |     | |   \n' +
  ' | |   | |   | |     | |             |           | |   |   |       |       |       | | | |         | |       | |   | |           | | | | |   | |   |         | | | | |         |     | |   | |     | |   \n' +
  ' | | +---|-----|-----|-----------------+         | |   | +---------|-+     |       | | | |         | |       | |   | |           | | | | |   | |   |         | | | | |         |     | |   | |     | |   \n' +
  ' | | | | |   | |     | |             | |         | |   | | |       | |     |       | | | |         | |       | |   | |           | | | | |   | |   |         | | | | |         |     | |   | |     | |   \n' +
  ' | | | | |   | |     | |             | |         | |   | | |       | |     |       | | | |         | |       | |   | |           | | | | |   | |   |         | | | | |         |     | |   | |     | |   \n' +
  ' | | | | |   | |     | |             | |         | |   | | |       | |     |       | | | |         | |       | |   | |           | | | | |   | |   |         | | | | |         |     | |   | |     | |   \n' +
  ' | | | | |   | |     | |             | |         | +-+ | | |       | |     +-----+ | | | |         | |       | |   | |           | | | +-|-+ | +-+ |         | | | | |         |     | |   | |     | |   \n' +
  ' | | | | |   | |     | |             | |         |   | | | |       | |           | | | | |         | |       | |   | |           | | |   | | |   | |         | | | | |         |     | |   | |     | |   \n' +
  ' | | | | |   | |     | |             | | +-------|-------------------|-----------|---|------------Y--|-------------|---------------|-----|---|-----|---------|---|-----------+ |     | |   | |     | |   \n' +
  ' | | | | X   | |     | |             | | |       |   | | | |       | |           | | | | |         | |       | |   | |           | | |   | | |   | |         | | | | |       | |     | |   | |     | |   \n' +
  ' | | | | |   | |     | |             | | |       |   | | | |       | |           | | | | | +---------|---------------------------------------|-----|-----------|---|---------|-|-----------+ |     | |   \n' +
  ' | | | | |   | |     | |             | | |       |   | | | |       | |           | | | | | |       | |       | |   | |           | | |   | | |   | |         | | | | |       | |     | |     |     | |   \n' +
  ' | | | | |   | |     | |             | | |       |   | | | |       | |           | | | | | |       | |       | |   | |           | | |   | | |   | |         | | | | |       | |     | |     |     | +-+ \n' +
  ' | | | | |   | |     | |             | | |       |   | | | |       | |           | | | | | |       | |       | |   | |           | | |   | | |   | |         | | | | |       | |     | |     |     |   | \n' +
  ' | | | | |   | |     +-|-------------------------|-----|-----------|-|-----------|---|-------------|---------|-|---|-|-----------|---------|-|---------------------|-|---------|-------|-----------|-+ | \n' +
  ' | | | | |   | |       |             | | |       |   | | | |       | |           | | | | | |       | |       | |   | |           | | |   | | |   | |         | | | | |       | |     | |     |     | | | \n' +
  ' | | | | |   | |       |             | | |       |   | +-|---------|-------------|-|-|-------------|---------|-|-----------------|-------+ | |   | |         | | | | |       | |     | |     |     | | | \n' +
  ' | | | | |   | |       |             | | |       |   |   | |       | |           | | | | | |       | |       | |   | |           | | |     | |   | |         | | | | |       | |     | |     |     | | | \n' +
  ' | +-----------|-----------------------|-|---+   | +---------------|-------------|---|-|-+ |       | |       | |   | |   +-------|---|-----|-|-+ | |         | | | | |       | |     | |     |     | | | \n' +
  ' |   | | |   | |       |             | | |   |   | | |   | |       | |           | | | |   |       | |       | |   | |   |       | | |     | | | | |         | | | | |       | |     | |     O     | | | \n' +
  ' |   | | |   | |       |             | | |   |   | | |   | |       | |           | +-|-----|-----------------|-|---|-+   |       | | |     | | | | |         | | | | |       | |     | |     |     | | | \n' +
  ' |   | | |   | |       |             | | |   |   | | |   | |       | |           |   | |   |       | |       | |   |     |       | | |     | | | | |         | | | | |       | |     | |     |     | | | \n' +
  ' |   | | |   | |       |             | | |   |   | | |   | |       | |           |   | |   +---------|-------|-|---|-----------------------|-|-|-|---+       | | | | |       | |     | |     |     | | | \n' +
  ' |   | | |   | |       |             | | |   |   | R |   | |       | |           |   | |           | |       | |   |     |       | | |     | | | | | |       | | | | |       | |     | |     |     | | | \n' +
  ' |   | | |   | |       |             | | |   |   | | |   | |       | |           |   | |           | |       | |   |     |       | | |     | | | | | |       | | | | |       | |     | |     |     | | | \n' +
  ' |   | | |   | |       |             | | |   |   | | |   | |       | |           |   | |           | |       | |   |     |       | | |     | | | | | |       | | | | |       | |     | |     |     | | | \n' +
  ' |   | | |   | |       |             | | |   |   | | | +-|---------|-|---------------|-------------|-+       | |   |     |       | | | +-----|-|-|-|-|-------|-|-|-----------|-|-----|-|---+ |     | | | \n' +
  ' |   | | |   | |       |             | | |   |   | | | | | |       | |           |   | |           |         | |   |     |       | | | |   | | | | | |       | | | | |       | |     | |   | |     | | | \n' +
  ' |   | | |   | |       |             | | |   +---|-|---+ | +---------|-----------|-----------------|---------|-----------------------|-----|-+ | | | | +---------|---|---+   | |     | |   | |     | | | \n' +
  ' |   | | |   | |       |             | | |       | | |   |         | |           |   | |           |         | |   |     |       | | | |   |   | | | | |     | | | | |   |   | |     | |   | |     | | | \n' +
  ' |   | | |   | |       |             | | |       | +-----|---------|-|---------------|-------------|-----------|---|-----|-----------|---------|-|---+ +-+   +-----|-|---------------+ |   | |     | | | \n' +
  ' |   | | |   | |       |             | | |       |   |   |         | |           |   | |           W         | |   |     |       | | | |   |   | | |     |     | | | |   |   | |       |   | |     | | | \n' +
  ' |   | | |   | |       |             | | |       |   |   |         | |           |   | |           |         | |   |     |   +---|-----|-------|---|---+ |   +-|-|---|-------|-|-------|-----|-+   | | | \n' +
  ' |   | | |   | |       |             | | |       |   |   |         | |           |   | |           |         | |   |     |   |   | | | |   |   | | |   | |   | | | | |   |   | |       |   | | |   | | | \n' +
  ' |   | | |   | |       |             | | |       |   |   |         | |           |   | |   +-------+         | |   |     |   |   | | +-|---------------------|---|-|-|---|-+ | |       |   | | |   | | | \n' +
  ' |   | | |   | |       |             | | |       |   |   |         | |           |   | |   |                 | |   |     |   |   | |   |   |   | | |   | |   | | | | |   | | | |       |   | | |   | | | \n' +
  ' |   | | |   | |       |             | | |       |   |   |         | |           |   | |   |                 | |   |     |   |   | |   |   |   | | | +-------------|-|---|---|-|-------+   | | +-----+ | \n' +
  ' |   | | |   | |       |             | | |       |   |   |         | |           |   | |   |                 | |   |     |   |   | |   |   |   | | | | | |   | | | | |   | | | |           | |     |   | \n' +
  ' |   | | |   | |       |             | | |     +-|-------|---------|-+           | +---+   |                 | | +-|-----|---------+ +-|-------------+ | |   | | | | |   | | | |           | |     |   | \n' +
  ' |   | | |   | |       |             | | |     | |   |   |         |             | | |     |                 | | | |     |   |   |   | |   |   | | |   | |   | | | | |   | | | |           | |     |   | \n' +
  ' |   | | | +-|-|-------|---------------|-------|-|-----------------|-------------|---|-----|-----------------|-|-|-|-----|-----------|-----|---|---|---|-|-----------|-----|-|-------------------------+ \n' +
  ' |   | | | | | |       |             | | |     | |   |   |         |             | | |     |                 | | | |     |   |   |   | |   |   | | |   | |   | | | | |   | | | |           | |     |     \n' +
  ' |   | | | +-------+   |             | | |   +-+ +-------|---------|-------------|---|-----------------------|-----|-----|-------|---|-----|-----|---+ | | +---|-+ | |   | | | |           | | +-------+ \n' +
  ' |   | | |   | |   |   |             | | |   |       |   |         |             | | |     |                 | | | |     |   |   |   | |   |   | | | | | | | | |   | |   | | | |           | | |   |   | \n' +
  ' |   | | |   | |   |   |             | +-----|-------|---+         |             | | |     |       +---+     | | | |     |   |   +---|-|---|-------|---|-----|-|---|---------|-----------+ | | |   |   | \n' +
  ' |   | | |   | |   |   |             |   |   |       |             |             | | |     |       |   |     | | | |     |   |       | |   |   | | | | | | | | |   | |   | | | |         | | | |   |   | \n' +
  ' |   | | |   | |   |   |             |   |   |       |             |             | | |     |     +-|-------------|-----------|---------------+ +-|-----|-+ +---|-----|---|-|-------------|---|-+   |   | \n' +
  ' |   | | |   | |   |   |             |   |   |       |             |             | | |     |     | |   |     | | | |     |   |       | |   | |   | | | |     | |   | |   | | | |         | | |     |   | \n' +
  ' |   | | |   +---------|-------------|-----------------------------------------------|-----|-------|---|-----|-----------|---|-------|-----|-|---|---+ |     | | +-|-|---|---|---------------|-+   |   | \n' +
  ' |   | | |     |   |   |             |   |   |       |             |             | | |     |     | |   |     | | | |     |   |       | |   | |   | |   |     | | | | |   | | | |         | | | |   |   | \n' +
  ' |   | | |     |   |   |             |   |   |       |   +-----------------------|-|-|-----------------------|---|-|-----|-----------|-|-----------------------|-|-------+ | | |   +-----|---|-|---|---+ \n' +
  ' |   | | |     |   |   |             |   |   |       |   |         |             | | |     |     | |   |     | | | |     |   |       | |   | |   | |   |     | | | | |     | | |   |     | | | |   |     \n' +
  ' |   | | |     |   |   |             |   |   |       |   +---+     |             | +-|-------------+   |     | | | |     |   | +-----+ |   | |   | |   |     | | | | |     | | |   |     | | | |   |     \n' +
  ' |   | E |     |   |   |             |   |   |       |       |     |             |   |     |     |     |     | | | |     |   | |       |   | |   | |   |     | | | | |     | | |   |     | | | |   |     \n' +
  ' |   | | |     |   |   |             |   |   |       |       |     | +-----------+   |   +-+     |     |     | | | |     |   | |       |   | | +-+ |   |     | | | | |     | | |   | +---|---|-+   |     \n' +
  ' |   | | |     |   |   |             |   |   |       |       |     | |               |   |       |     |     | | | |     |   | |       |   | | |   |   |     | | | | |     | | |   | |   | | |     |     \n' +
  ' |   | | |     |   |   |             |   |   |       |       +-----------------------|---|-------|-----|-----------------------------------|-|---------------|-------|-----|---|---------|-|-----------+ \n' +
  ' |   | | |     |   |   |             |   |   |       |             | |               |   |       |     |     | | | |     |   | |       |   | | |   |   |     | | | | |     | | |   | |   | | |     |   | \n' +
  ' | +-|---------|---|---------------------|---|-------|-----------------------+       |   |     +-------------|---------+ |   | |       |   | | |   |   |     | | | | |     | | |   | |   | | |     |   | \n' +
  ' | | | | |     |   |   |             |   |   |       |             | |       |       |   |     | |     |     | | | |   | |   | |       |   | | |   |   |     | | | | |     | | |   | |   | | |     |   | \n' +
  ' | | | | |     |   |   |             |   |   |       |     +-----------+     |     +-----|-----|---+   |     +-|-------|-|-----------------|-|---------|-------|-|-------------------|---|-------+ | +-+ \n' +
  ' | | | | |     |   |   |             |   |   |       |     |       | | |     |     | |   |     | | |   |       | | |   | |   | |       |   | | |   |   |     | | | | |     | | |   | |   | | |   | | |   \n' +
  ' | | | | |     |   |   |             |   |   |       |     |       | | |     |     | |   |     | | |   |       | | |   | |   | |       +-------|---|---------|-|-|---------|-|-|-----|-----|-|-+ | | |   \n' +
  ' | | | | |     |   |   |             |   |   |       |     |       | | |     |     | |   |     | | |   |       | | |   | |   | |           | | |   |   |     | | | | |     | | |   | |   | | | | | | |   \n' +
  ' | | | | |     |   |   |             |   |   |       |     |       | | |     |     | |   |   +-----|-------------|-------------|-----------|-|-|---|---|---------|---|---------|---|-|-----+ | | | | |   \n' +
  ' | | | | |     |   |   |             |   |   |       |     |       | | |     |     | |   |   | | | |   |       | | |   | |   | |           | | |   |   |     | | | | |     | | |   | |   |   | | | | |   \n' +
  ' | | | | |     |   |   |             |   |   |       |     |       | | |     |     | |   |   | | | |   +-----------|-----|-----|---------+ | | |   |   |     | | | | |     | | |   | |   |   | | | | |   \n' +
  ' | | | | |     |   |   |             |   |   |       |     |       | | |     |     | |   |   | | | |           | | |   | |   | |         | | | |   |   |     | | | | |     | | |   | |   |   | | | | |   \n' +
  ' | | | | | +-----------------------------------------------|-------|---|-----|-----------------------+         | | |   | |   | |         | | | |   |   |     | | | | |     | | |   | |   |   | | | | |   \n' +
  ' | | | | | |   |   |   |             |   |   |       |     |       | | |     |     | |   |   | | | | |         | | |   | |   | |         | | | |   |   |     | | | | |     | | |   | |   |   | | | | |   \n' +
  ' | | | | | +-------------------------------------------------------|-|-------|---+ | |   | +-|-----|-------------|-|---|-|---|---------------|-|---|---|-------------|-+   | | |   | |   |   | | | | |   \n' +
  ' | | | | |     |   |   |             |   |   |       |     |       | | |     |   | | |   | | | | | | |         | | |   | |   | |         | | | |   |   |     | | | | | |   | | |   | |   |   | | | | |   \n' +
  ' | | | | |     |   |   |             |   |   |       |   +-|-----------|-----------|-----|---+ | | | |         | | |   +-----|-|-----------+ | |   |   |     | | | | | |   | | |   | |   |   | | | | |   \n' +
  ' | | | | |     |   |   |             |   |   |       |   | |       | | |     |   | | |   | |   | | | |         | | |     |   | |         |   | |   |   |     | | | | | |   | | |   | |   |   | | | | |   \n' +
  ' | +---|---------------------------------|---|-+ +---|---|-|-------|-|-----------|-|-|--H--------|---|-------------------|---|-|-----------------------+     | | | | | |   | | |   | |   |   | | | | |   \n' +
  ' |   | | |     |   |   |             |   |   | | |   |   | |       | | |     |   | | |   | |   | | | |         | | |     |   | |         |   | |   |         | | | | | |   | | |   | |   |   | | | | |   \n' +
  ' |   | | |     |   |   |             | +-----|-|-|-------|-|---------|-|---------|---|---|-------|---|-------------|-----|-------------------|-----|---------|-|-------|-----|-----+ |   |   | +-|---+   \n' +
  ' |   | | |     |   |   |             | | |   | | |   |   | |       | | |     |   | | |   | |   | | | |         | | |     |   | |         |   | |   |         | | | | | |   | | |     |   |   |   | |     \n' +
  ' |   | | |     |   |   |             | | |   | | |   |   | |       | | |     |   | | |   | |   | | | |         | +-------------+         |   | |   |   +-+   | | | | +-|---|-|-------|---|-------|-|-+   \n' +
  ' |   | | |     |   |   |             | | |   | | |   |   | |       | | |     |   | | |   | |   | | | |         |   |     |   |           |   | |   |   | |   | | | |   |   | | |     |   |   |   | | |   \n' +
  ' |   | | |     |   +---------------------|---|-|-----|-------------|-------------------------------|-|-------------|---------|---------------------------|---+ | | |   |   | | |     |   |   |   | | |   \n' +
  ' |   | | |     |       |             | | |   | | |   |   | |       | | |     |   | | |   | |   | | | |         |   |     |   |           |   | |   |   | |     | | |   |   | | |     |   |   |   | | |   \n' +
  ' |   | | |     |       |             | | |   | +-----|-----|-------|---|-----------------|-|---|---|-|-----------------------------------|---------|---|-------|---+   |   | | |     |   +-----+ | | |   \n' +
  ' |   | | |     |       |             | | |   |   |   |   | |       | | |     |   | | |   | |   | | | |         |   |     |   |           |   | |   |   | |     | |     |   | | |     |       | | | | |   \n' +
  ' |   | | |     |       |             | +-|---------------|-+       | | |     +-------|---|-----------|-----------+ |     |   |     +---------|-----|---|-------|-|-+   |   | | |     |       | | | | |   \n' +
  ' |   | | |     |       |             |   |   |   |   |   |         | | |         | | |   | |   | | | |         | | |     |   |     |     |   | |   |   | |     | | |   |   | | |     |       | | | | |   \n' +
  ' |   | | |     |       |             | +-------------|---|-------------+         | | |   | |   | | | |         | | |     |   |     |     |   | |   |   | |     | | |   |   | | |     |       | | | | |   \n' +
  ' |   | | |     |       |             | | |   |   |   |   |         | |           | | |   | |   | | | |         | | |     |   |     |     |   | |   |   | |     | | |   |   | | |     |       | | | | |   \n' +
  ' |   | | |     |       |   +---------|-|-|-------------------------|-----------------|---|-------|-|-------------|-|-----|---------|-----|---------|---|-------|-+ |   |   | | |     |       | | | | |   \n' +
  ' |   | | |     |       |   |         | | |   |   |   |   |         | |           | | |   | |   | | | |         | | |     |   |     |     |   | |   |   | |     |   |   |   | | |     |       | | | | |   \n' +
  ' | +-|-|-------|-------|-------------|-------|---+   |   |         | |   +-----------+   | |   | | | |         | | |     |   |     |     |   | |   |   | |     |   |   |   +-----+   |       | | | | |   \n' +
  ' | | | | |     |       |   |         | | |   |       |   |         | |   |       | |     | |   | | | |         | | |     |   |     |     |   | |   |   | |     |   |   |     | | |   |       | | | | |   \n' +
  ' | | | | |   +-|-----------+         | | |   |       |   |         | |   |       | +-+   | |   | | | |         | +-|-------+ |     |     | +-------|---------------|---------|---+   |       | | | | |   \n' +
  ' | | | | |   | |       |             | | |   |       |   |         | |   |       |   |   | |   | | | |         |   |     | | |     |     | | | |   |   | |     |   |   |     | |     |       | | | | |   \n' +
  ' | | | | |   | |   +-----------+     | | |   |       |   |         | |   |       +---|-------------|-----------|-------------|-----------|-|---|---------+     |   |   |     | |     |       | | | | |   \n' +
  ' | | | | |   | |   |   |       |     | | |   |       |   |         | |   |           |   | |   | | | |         |   |     | | |     |     | | | |   |   |       |   |   |     | |     |       | | | | |   \n' +
  ' | | | | | +-|-----+   |       |     | | |   |       |   |     +---------------------|---|-|---|-|---|-------------|-----|---|-----|-------|-|-|---------------|---------------|-----------------|---+   \n' +
  ' | | | | | | | |       |       |     | | |   |       |   |     |   | |   |           |   | |   | | | |         |   |     | | |     |     | | | |   |   |       |   |   |     | |     |       | | | |     \n' +
  ' | | | | | | | |       |       |     | | | +-|-------|---|-----------|---------------+   | +---|-|-+ +-+       |   |     | +-------+   +-+ | | |   |   |       |   | +-------+ |     |       | | | |     \n' +
  ' | | | | | | | |       |       |     | | | | |       |   |     |   | |   |               |     | |     |       |   |     |   |         |   | | |   |   |       |   | | |       |     |       | | | |     \n' +
  ' | | | | +-|-|-----------------+   +---+ | | |       |   |     +---|-|---|---------------------|-------|-------------------------------|---|-|-----|---|-------|-+ | | |   +---|-----|-+     | | | |     \n' +
  ' | | | |   | | |       |           | |   | | |       |   |         | |   |               |     | |     |       |   |     |   |         |   | | |   |   |       | | | | |   |   |     | |     | | | |     \n' +
  ' | | | |   | | |       |           +-|-----|---------|-------------|-|-------------------------|-|-------------|-------------|---------|-----|-|---|---|-----+ | +-|-+ |   |   | +---+ |     | | | |     \n' +
  ' | | | |   | | |       |             |   | | |       |   |         | |   |               |     | |     |       |   |     |   |         |   | | |   |   |     | |   |   |   |   | |     |     | | | |     \n' +
  ' | +-|-|---|-|---------|-------------|---|-----------|---|-----------|-----------------+ |     | |   +-|---------+ |     |   |   +-----|-----|-|---|-----------|---|-------|---|-|-----+     | | | |     \n' +
  ' |   | |   | | |       |             |   | | |       |   |         | |   |             | |     | |   | |       | | |     |   |   |     |   | | |   |   |     | |   |   |   |   | |           | | | |     \n' +
  ' | +-|-|-+ | | |       |             +-----|-|-------|---------------------------------|-------|-------+       +---------+   +---|-----|---|-|-|---+   |     +---------+   |   | |           | | +-|---+ \n' +
  ' | | | | | | | |       |                 | | |       |   |         | |   |             | |     | |   |           | |             |     |   | | |       |       |   |       |   | |           | |   |   | \n' +
  ' | +-|-+ +-----|-------------------------|---|-------+   |         | |   |             +---------|-----+         | |       +---------------|---|-------|-------|---|-----------|-------------|-----|---+ \n' +
  ' |   |     | | |       |                 | | |           |         | |   |               |     | |   | |         | |       |     |     |   | | |       |       |   |       |   | |           | |   |     \n' +
  ' | +---+   | +---------|---------------------|-----------------------|---|---------------|-----|-----------------+ |       | +---------+   | | |       |       |   |       |   | |           | |   |     \n' +
  ' | | | |   |   |       |                 | | |           |         | |   |               |     | |   | |           |       | |   |         | | |       |       |   |       |   | |           | |   |     \n' +
  ' | +-|-|-------|-------+                 | | +-----------|---------|-|---|-----------------------|-----|-----------|---------|---|---------|---|-------------------|-------------|-----------+ |   |     \n' +
  ' |   | |   |   |                         | |             |         | |   |               |     | |   | |           |       | |   |         | | |       |       |   |       |   | |             |   |     \n' +
  ' +---+ |   |   |           +-------------+ +-----------------------|-+   |               |   +---|---+ +-----------|-------|-----|-----------|-|-------+       +---|-------+   | +-----------+ |   |     \n' +
  '       |   |   |           |                             |         |     |               |   | | |                 |       | |   |         | | |                   |           |             | |   |     \n' +
  '       +---+   +-----------+                             |         |     +---------------+   +-+ +-----------------+       | |   +-----------|-------------------+ |           |             | |   |     \n' +
  '                                                         |         |                                                       | |             | | |                 | |           |             | |   |     \n' +
  '                                             +-----------|-----------------------------------------------------------------|-|-------------|---|-----------------+ +---+       |             | |   |     \n' +
  '                                             |           |         |                                                       | |             | | |                       |       |             | |   |     \n' +
  '                                             +-----------+         +-------------------------------------------------------+ +---N         +-+ +-----------------------+       +-------------+ +---+     \n' +
  '                                                                                                                                                                                                         \n';
// input = '     |          \n' +
//   '     |  +--+    \n' +
//   '     A  |  C    \n' +
//   ' F---|----E|--+ \n' +
//   '     |  |  |  D \n' +
//   '     +B-+  +--+';
const maze = input.split('\n').map(val => val.split(''));

const mazeValue = point => maze[point[0]] && maze[point[0]][point[1]];
const getNextPoint = {
  down: point => [point[0] + 1, point[1]],
  up: point => [point[0] - 1, point[1]],
  left: point => [point[0], point[1] - 1],
  right: point => [point[0], point[1] + 1],
};
const opposite = {
  down: 'up',
  up: 'down',
  left: 'right',
  right: 'left'
};
const getNextDir = (dir, point) => {
  return Object.keys(getNextPoint).filter(nextDir => {
    const repeat = nextDir === opposite[dir];
    const nextPoint = getNextPoint[nextDir](point);
    if (!repeat && mazeValue(nextPoint)) {
      const horizontal = (nextDir === 'right' || nextDir === 'left') &&
        [' ', '|'].indexOf(mazeValue(nextPoint)) < 0;
      const vertical = (nextDir === 'up' || nextDir === 'down') &&
        [' ', '-'].indexOf(mazeValue(nextPoint)) < 0;
      return horizontal || vertical;
    }
    return false;
  })[0];
};

let path = [];
let point = [0, maze[0].indexOf('|')];
let dir = 'down';

let count = 0;
while (dir) {

  count++;
  const nextPoint = getNextPoint[dir](point);
  const value = mazeValue(nextPoint);
  if (value && value !== ' ') {
    console.log(point);
    path.push(point);
    point = nextPoint;
  } else {
    dir = mazeValue(point) === '+' ?
      getNextDir(dir, point) :
      null;
  }
}
console.log(path.length);
